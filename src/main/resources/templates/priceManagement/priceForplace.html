<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header::header-css">
    <meta charset="UTF-8">
    <base href="https://demos.telerik.com/kendo-ui/grid/detailtemplate">
    <title>价格绑定</title>
</head>

<body class="hold-transition skin-blue sidebar-mini">
<div th:replace="fragments/header :: header-body"/>
<div class="content-wrapper">

    <section  class="content-header">
        <h1>
            价格绑定
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i>首页</a></li>
            <li class="active">价格绑定</li>
        </ol>
    </section>

    <div class="container-fluid">
        <div id="example">
            <div id="grid"></div>
            <script type="text/x-kendo-template" id="template1">
                <!--#if(data.isNew()) {#-->
                <!--#var createTemp = kendo.template($("\#createTemplate").html());#-->
                <!--#=createTemp(data)#-->
                <!--#} else {#-->
                <!--#var createTemp = kendo.template($("\#editTemplate").html());#-->
                <!--#=createTemp(data)#-->
                <!--#}#-->
                <div id ="edit-1"></div>
                <div id = "edit-2"></div>
            </script>

            <script type="text/x-kendo-template" id="template2">

                <div id ="edit-3"></div>
                <div id = "edit-4"></div>

            </script>
            <script type="text/x-kendo-template" id="editTemplate" >

            </script>



            <script type="text/x-kendo-template" id="template">
                <div class="tabstrip">
                    <ul>
                        <li class="k-state-active">
                            按摩椅
                        </li>
                        <!--<li>-->
                            <!--子场地-->
                        <!--</li>-->
                    </ul>
                    <div>
                        <div class="orders"></div>
                    </div>
                    <div>
                        <div class='employee-details'>
                            <!--<ul>-->
                              <!--<div class="son"></div>-->
                            <!--</ul>-->
                        </div>
                    </div>
                </div>

            </script>

            <script>

                $(document).ready(function() {

                     $("#grid").kendoGrid({
                        dataSource: {
                            type: "json",
                            transport: {
                                read:  {
                                    url: "./placeMgr/getAllPlace",
                                    dataType: "json"
                                },
                                parameterMap: function(options, operation) {
                                    if (operation !== "read" && options.models) {
                                        return  kendo.stringify(options.models);
                                    }
                                }
                            },
                            pageSize: 10,
                            // serverPaging: true,
                            // serverSorting: true,
                            filterable:true,
                            scrollable: true,
                            schema: {
                                model: {
                                    id: "id",
                                    fields: {
                                        id: { editable: false, nullable: true },
                                        placeSn: { type: "string",editable: false},
                                        name: { type: "string",editable: false },
                                        placeAddress: { type: "string",editable: false },
                                        city: { type: "array",editable: false },
                                        principal:{type:"string",editable:false}
                                    }
                                }
                            }
                        },
                        height: 600,
                         groupable: true,
                         resizable: true,
                         columnMenu:true,
                         sortable: true, //表示是否支持排序， boolean型
                         filterable: true,//filterable表示过滤，即能进行等于，不等于，包含，已开头等过滤操作，boolean型
                         pageable: {
                             // empty:"没有要显示的数据",
                             // //代表是否支持刷新
                             // refresh: true,
                             // //表示每页显示的记录数，默认为5,10,20
                             pageSizes: true,
                             // //表示显示的页数，5表示1,2,3,4,5
                             buttonCount: 5,
                             totalPages: true,
                             // input: true,//表示是否可以输入数字
                             refresh: true,
                             pageSize: 10,
                             pageSizes: [5, 10, 15, 20],
                             // numeric: true,
                             // input: true,
                             // messages: {
                             //     display: "显示 {0}-{1} 条，共 {2} 条",
                             //     empty: "没有数据",
                             //     itemsPerPage: "每页显示数量",
                             //     first: "第一页",
                             //     last: "最后一页",
                             //     next: "下一页",
                             //     previous: "上一页",
                             //     page: "页",
                             //     of: "共 {0}页"
                             // }
                         },

                        detailTemplate: kendo.template($("#template").html()),


                        detailInit: detailInit,
                        // dataBound: function() {
                        //     this.expandRow(this.tbody.find("tr.k-master-row").first());
                        // },
                        columns: [
                            {
                                field: "name",
                                title: "场地名称",
                                width: "120px"
                            },
                            {
                                field: "placeAddress",
                                title: "地址",
                                width: "120px"
                            },

                            {
                                field: "placeSn",
                                title:"场地编码",
                                width: "120px"
                            },{
                                field: "principal",
                                title:"场地负责人",
                                width: "120px"
                            },
                            { command: [{name:"edit",text:"价格绑定"}], title: "&nbsp;", width: "160px" },
                        ],

                        editable: {
                            mode: "popup",
                            width:500,
                            title:"场地价格绑定",
                            template: $("#template1").html()
                        },

                        edit: function(e){
                            let placeId = e.model.id;
                          let  dataSource = new kendo.data.DataSource({
                                transport: {
                                    read: {
                                        url: "./price/status",
                                        dataType: "json"
                                    },
                                    destroy: {
                                        url: "./price/placeAddPrice",
                                        dataType: "json",
                                        type: "post",
                                        contentType : "application/json"
                                    },
                                    parameterMap: function (options, operation) {
                                        if (operation === "destroy" && options.models) {
                                            let array = [];
                                               for (let j =0 ;j<options.models.length;j++){
                                                   array[j] = options.models[j].id;
                                               }

                                           let list1 = {
                                               price :  array,
                                               placeId : placeId
                                           }
                                           return kendo.stringify(list1);
                                        }
                                        if (operation !== "read" && options.models) {
                                            return kendo.stringify(options.models) ;
                                        }
                                    }
                                },
                                batch: true,
                                pageSize: 5,
                              persistSelection: true,
                              pageable: {
                                  // empty:"没有要显示的数据",
                                  // //代表是否支持刷新
                                  // refresh: true,
                                  // //表示每页显示的记录数，默认为5,10,20
                                  pageSizes: true,
                                  // //表示显示的页数，5表示1,2,3,4,5
                                  buttonCount: 5,
                                  totalPages: true,
                                  // input: true,//表示是否可以输入数字
                                  refresh: true,
                                  pageSize: 10,
                                  pageSizes: [5, 10, 15, 20],
                                  // numeric: true,
                                  // input: true,
                                  // messages: {
                                  //     display: "显示 {0}-{1} 条，共 {2} 条",
                                  //     empty: "没有数据",
                                  //     itemsPerPage: "每页显示数量",
                                  //     first: "第一页",
                                  //     last: "最后一页",
                                  //     next: "下一页",
                                  //     previous: "上一页",
                                  //     page: "页",
                                  //     of: "共 {0}页"
                                  // }
                              },
                                schema: {
                                    model: {
                                        id: "id",
                                        fields: {
                                            id: { editable: false, nullable: true },
                                            price: { type: "number", validation: { required: true, min: 1} ,editable: false},
                                            useTime: { type: "number" ,validation: { required: true, min: 1} ,editable: false},
                                            createDateTime: { type: "Date",editable: false , format: "{0:yyyy-MM-dd HH:mm:ss}"},
                                            startDateTime: { type: "Date" ,editable: false, format: "{0:yyyy-MM-dd HH:mm:ss}"},
                                            endDateTime: { type: "Date",editable: false, format: "{0:yyyy-MM-dd HH:mm:ss}"},
                                            userId: { type: "string" ,editable: false},
                                            status: { type: "number",editable: false },
                                            priceName : {type : "string",editable: false},
                                            user :{type:"array",editable: false},
                                            deviceModelEntity:{type:"array",editable: false}
                                        }
                                    }
                                }
                            });
                            $("#edit-1").kendoGrid({
                                toolbar:[ {name: "save", text: "价格绑定"},{name: "cancel", text: "返回"}],
                                dataSource: dataSource,
                                pageable: {
                                    // empty:"没有要显示的数据",
                                    // //代表是否支持刷新
                                    // refresh: true,
                                    // //表示每页显示的记录数，默认为5,10,20
                                    pageSizes: true,
                                    // //表示显示的页数，5表示1,2,3,4,5
                                    buttonCount: 5,
                                    totalPages: true,
                                    // input: true,//表示是否可以输入数字
                                    refresh: true,
                                    pageSize: 10,
                                    pageSizes: [5, 10, 15, 20],
                                    // numeric: true,
                                    // input: true,
                                    // messages: {
                                    //     display: "显示 {0}-{1} 条，共 {2} 条",
                                    //     empty: "没有数据",
                                    //     itemsPerPage: "每页显示数量",
                                    //     first: "第一页",
                                    //     last: "最后一页",
                                    //     next: "下一页",
                                    //     previous: "上一页",
                                    //     page: "页",
                                    //     of: "共 {0}页"
                                    // }
                                },
                                columnMenu:true,
                                sortable:true,
                                filterable:true,
                                resizable: true,
                                scrollable: true,
                                height: 350,
                                columns: [
                                    // { selectable: true, width: "50px" },
                                    { field: "priceName", title: "价格名称",  width: "80px" },
                                    { field: "price", title: "价格(元)", width: "80px" },
                                    { field: "useTime", title:"使用时长(分钟)",width: "80px" },
                                    { field: "deviceModelEntity", title: "按摩椅类型", width: "100px", filterable: { multi: true },template:"#=deviceModelEntity.name#"},
                                    { field: "startDateTime", title:"开始时间",width: "100px" ,format: "{0: yyyy-MM-dd}"},
                                    { field: "endDateTime", title:"结束时间",width: "100px",format: "{0: yyyy-MM-dd}" },
                                    { command: [{
                                            name :"价格绑定",click:function (e) {
                                                var tr = $(e.target).closest("tr");
                                                var data = this.dataItem(tr);
                                                var priceId = data. id;
                                                var array = [priceId];
                                                let list1 = {
                                                    price :  array,
                                                    placeId : placeId
                                                }
                                                $.ajax({
                                                    type: "POST",
                                                    url: "./price/placeAddPrice",
                                                    data: kendo.stringify(list1),
                                                    contentType: "application/json; charset=utf-8",
                                                    dataType: "json",
                                                    success:function (data) {
                                                    alert("保存成功");
                                                }

                                                })
                                            }
                                        }], title: "&nbsp;", width: "50px" },],

                                editable: true,

                            });
                            // $("#edit-1").on("click", "tbody tr[role='row'] td", function () {
                            //     if ($(this).html().indexOf("k-checkbox") > 0) {//判断点击项是不是checkbox，不是的情况下再进行行选中的操作
                            //         $("#edit-1 tr").removeClass("chooseRow");
                            //         $(this).parent().addClass("chooseRow"); //添加行选中的样式
                            //         var index = $(this).parent().index();   //获取选中行的下标
                            //         var selectedId = $("#grid").data("kendoGrid")
                            //             .dataSource.at(index).id;  //获取选中行的ID
                            //     }
                            //
                            // });
                        },

                    });

                    function detailInit(e) {
                        var detailRow = e.detailRow;
                        var placeId = e.data.id;

                        detailRow.find(".tabstrip").kendoTabStrip({
                            animation: {
                                open: { effects: "fadeIn" }
                            }
                        });
                        //
                        //
                        // detailRow.find(".son").kendoGrid({
                        //     dataSource: {
                        //         type: "json",
                        //         transport: {
                        //             read:  {
                        //                 url: "./placeMgr/findPlaceByParentId?placeId="+placeId,
                        //                 dataType: "json"
                        //             },
                        //             parameterMap: function(options, operation) {
                        //                 if (operation !== "read" && options.models) {
                        //                     return  kendo.stringify(options.models);
                        //                 }
                        //             }
                        //         },
                        //         pageSize: 20,
                        //         // serverPaging: true,
                        //         // serverSorting: true,
                        //         schema: {
                        //             model: {
                        //                 id: "id",
                        //                 fields: {
                        //                     id: { editable: false, nullable: true },
                        //                     placeSn: { type: "string",editable: false},
                        //                     name: { type: "string",editable: false },
                        //                     placeAddress: { type: "string",editable: false },
                        //                     city: { type: "array",editable: false },
                        //                     principal:{type:"string",editable:false}
                        //                 }
                        //             }
                        //         }
                        //     },
                        //     height: 600,
                        //     sortable: true,
                        //     pageable: true,
                        //     groupable: true,
                        //     filterable:true,
                        //     scrollable: true,
                        //     detailTemplate: kendo.template($("#template").html()),
                        //
                        //
                        //     detailInit: detailInit,
                        //     // dataBound: function() {
                        //     //     this.expandRow(this.tbody.find("tr.k-master-row").first());
                        //     // },
                        //     columns: [
                        //         {
                        //             field: "name",
                        //             title: "场地名",
                        //             width: "120px"
                        //         },
                        //         {
                        //             field: "placeAddress",
                        //             title: "场地地点",
                        //             width: "120px"
                        //         },
                        //
                        //         {
                        //             field: "placeSn",
                        //             title:"场地编码",
                        //             width: "120px"
                        //         },{
                        //             field: "principal",
                        //             title:"场地负责人",
                        //             width: "120px"
                        //         },
                        //         { command: [ {
                        //                 name: "edit",text: "价格绑定"}
                        //             ], title: "&nbsp;", width: "160px" }
                        //     ],
                        //
                        //     editable: {
                        //         mode: "popup",
                        //         width:500,
                        //         title:"场地价格绑定",
                        //         template: $("#template1").html()
                        //     },
                        //
                        //     edit: function(e){
                        //         let placeId = e.model.id;
                        //
                        //         let  dataSource = new kendo.data.DataSource({
                        //             transport: {
                        //                 read: {
                        //                     url: "./price/status",
                        //                     dataType: "json"
                        //                 },
                        //                 destroy: {
                        //                     url: "./price/placeAddPrice",
                        //                     dataType: "json",
                        //                     type: "post",
                        //                     contentType : "application/json"
                        //                 },
                        //                 parameterMap: function (options, operation) {
                        //                     if (operation === "update" && options.models) {
                        //                         let array = [];
                        //                         for (let j =0 ;j<options.models.length;j++){
                        //                             array[j] = options.models[j].id;
                        //                         }
                        //
                        //                         let list1 = {
                        //                             price :  array,
                        //                             placeId : placeId
                        //                         }
                        //                         return kendo.stringify(list1);
                        //                     }
                        //                     if (operation !== "read" && options.models) {
                        //                         return kendo.stringify(options.models) ;
                        //                     }
                        //                 }
                        //             },
                        //             batch: true,
                        //             pageSize: 5,
                        //             schema: {
                        //                 model: {
                        //                     id: "id",
                        //                     fields: {
                        //                         id: { editable: false, nullable: true },
                        //                         price: { type: "number", validation: { required: true, min: 1} ,editable: false},
                        //                         useTime: { type: "number" ,validation: { required: true, min: 1} ,editable: false},
                        //                         createDateTime: { type: "Date",editable: false },
                        //                         startDateTime: { type: "Date" ,editable: false},
                        //                         endDateTime: { type: "Date",editable: false},
                        //                         userId: { type: "string" ,editable: false},
                        //                         status: { type: "number",editable: false },
                        //                         priceName : {type : "string",editable: false},
                        //                         user :{type:"array",editable: false},
                        //                         deviceModelEntity:{type:"array",editable: false}
                        //                     }
                        //                 }
                        //             }
                        //         });
                        //         $("#edit-1").kendoGrid({
                        //             toolbar: [ "可绑定价格"],
                        //             dataSource: dataSource,
                        //             pageable: true,
                        //             filterable:true,
                        //             scrollable: true,
                        //             sortable:true,
                        //             height: 350,
                        //             columns: [
                        //                 // { selectable: true, width: "50px" },
                        //                 { field: "priceName", title: "价格名称",  width: "80px" },
                        //                 { field: "price", title: "价格(元)", width: "80px" },
                        //                 { field: "useTime", title:"使用时长",width: "80px" },
                        //                 { field: "deviceModelEntity", title: "按摩椅类型", width: "100px", filterable: { multi: true },template:"#=deviceModelEntity.name#"},
                        //                 { field: "startDateTime", title:"开始时间",width: "100px" ,format: "{0: yyyy-MM-dd}"},
                        //                 { field: "endDateTime", title:"结束时间",width: "100px",format: "{0: yyyy-MM-dd}" },
                        //                 { command: [{
                        //                         name :"价格绑定",click:function (e) {
                        //                             var tr = $(e.target).closest("tr");
                        //                             var data = this.dataItem(tr);
                        //                             var priceId = data. id;
                        //                             var array = [priceId];
                        //                             let list1 = {
                        //                                 price :  array,
                        //                                 placeId : placeId
                        //                             }
                        //                             $.ajax({
                        //                                 type: "POST",
                        //                                 url: "./price/placeAddPrice",
                        //                                 data: kendo.stringify(list1),
                        //                                 contentType: "application/json; charset=utf-8",
                        //                                 dataType: "json",
                        //                                 success:function (data) {
                        //                                     alert("保存成功");
                        //                                 }
                        //
                        //                             })
                        //                         }
                        //                     }], title: "&nbsp;", width: "50px" }],
                        //
                        //             editable: true,
                        //
                        //         });
                        //     },
                        //
                        // });
                        detailRow.find(".orders").kendoGrid({
                            dataSource: {
                                type: "json",
                                transport: {
                                    read: "./place/findDeviceByPlaceId?placeId="+placeId,
                                },
                                // serverPaging: true,
                                // serverSorting: true,
                                // serverFiltering: true,
                                pageSize: 5,
                                schema: {
                                    model: {
                                        id: "id",
                                        fields: {
                                            id: { editable: false, nullable: true },
                                            maintainDateTime: { type: "timestamp"},
                                            latitude: { type: "number" ,editable: false,validation: { required: true, min: 1} },
                                            longitude: { type: "number",editable: false },
                                            deviceModelEntity: { type: "array",editable: false },
                                            supplierEntity: { type: "array",editable: false },
                                            mcStatus: { type: "boolean",editable: false },
                                            mcSn: { type: "string" ,editable: false},
                                            loraId: { type: "string" ,editable: false},
                                            placeEntity:{type:"array",editable: false},
                                            priceEntities :{type:"array",editable: false},
                                        }
                                    }
                                }

                            },
                            scrollable: true,
                            sortable: true,
                            resizable: true,
                            pageable: {
                                // empty:"没有要显示的数据",
                                // //代表是否支持刷新
                                // refresh: true,
                                // //表示每页显示的记录数，默认为5,10,20
                                pageSizes: true,
                                // //表示显示的页数，5表示1,2,3,4,5
                                buttonCount: 5,
                                totalPages: true,
                                // input: true,//表示是否可以输入数字
                                refresh: true,
                                pageSize: 10,
                                pageSizes: [5, 10, 15, 20],
                                // numeric: true,
                                // input: true,
                                // messages: {
                                //     display: "显示 {0}-{1} 条，共 {2} 条",
                                //     empty: "没有数据",
                                //     itemsPerPage: "每页显示数量",
                                //     first: "第一页",
                                //     last: "最后一页",
                                //     next: "下一页",
                                //     previous: "上一页",
                                //     page: "页",
                                //     of: "共 {0}页"
                                // }
                            },
                            columnMenu:true,
                            groupable: true,
                            filterable: true,
                            // filterable: true,
                            columns: [
                                { field: "mcSn", title:"按摩椅编号" ,width: "110px"},
                                { field: "loraId", title:"模块编号" ,width: "110px"},
                                { field: "deviceModelEntity", title:"所属型号", width: "110px",template:"#=deviceModelEntity.name#" },
                                { field: "placeEntity", title:"所属场地", width: "110px",template:"#=placeEntity.name#" },
                                { field: "latitude", title:"按摩椅所在经度", width: "110px" },
                                { field: "longitude", title:"按摩椅所在纬度", width: "110px" },
                                { command: [{name:"edit",text:"价格绑定"}], title: "&nbsp;", width: "160px" },
                            ],
                            editable: {
                                mode: "popup",
                                template: $("#template2").html()
                            },
                            edit: function(e){
                                let deviceId = e.model.id;
                               let dataSource = new kendo.data.DataSource({
                                    transport: {
                                        read: {
                                            url: "./price/devicePrice?deviceId="+deviceId,
                                            dataType: "json"
                                        },
                                        destroy: {
                                            url: "./price/deviceDeletePrice",
                                            dataType: "json",
                                            type: "post",
                                            contentType : "application/json"
                                        },
                                        parameterMap: function (options, operation) {
                                            if (operation === "destroy" && options.models) {
                                                let array = [];
                                                for (let j =0 ;j<options.models.length;j++){
                                                    array[j] = options.models[j].id;
                                                }

                                                let list1 = {
                                                    price :  array,
                                                    deviceId : deviceId
                                                }
                                                return kendo.stringify(list1);
                                            }
                                            if (operation !== "read" && options.models) {
                                                return kendo.stringify(options.models) ;
                                            }
                                        }
                                    },
                                    batch: true,
                                    pageSize: 5,
                                    schema: {
                                        model: {
                                            id: "id",
                                            fields: {
                                                id: { editable: false, nullable: true },
                                                price: { type: "number", validation: { required: true, min: 1},editable: false },
                                                useTime: { type: "number" ,validation: { required: true, min: 1} ,editable: false},
                                                createDateTime: { type: "Date",editable: false },
                                                startDateTime: { type: "Date" ,editable: false},
                                                endDateTime: { type: "Date" ,editable: false},
                                                userId: { type: "string" ,editable: false},
                                                status: { type: "number" ,editable: false},
                                                priceName : {type : "string",editable: false},
                                                user :{type:"array"}
                                            }
                                        }
                                    }
                                });
                              let  dataSource1 = new kendo.data.DataSource({
                                    transport: {
                                        read: {
                                            url: "./price/deviceUnPrice?deviceId=" + deviceId,
                                            dataType: "json"
                                        },
                                        destroy: {
                                            url: "./price/deviceSavePrice",
                                            dataType: "json",
                                            type: "post",
                                            contentType : "application/json"
                                        },
                                        parameterMap: function (options, operation) {
                                            if (operation === "destroy" && options.models) {
                                                let array = [];
                                                for (let j =0 ;j<options.models.length;j++){
                                                    array[j] = options.models[j].id;
                                                }

                                                let list1 = {
                                                    price :  array,
                                                    deviceId : deviceId
                                                }
                                                return kendo.stringify(list1);
                                            }
                                            if (operation !== "read" && options.models) {
                                                return kendo.stringify(options.models) ;
                                            }
                                        }
                                    },
                                    batch: true,
                                    pageSize: 5,
                                    schema: {
                                        model: {
                                            id: "id",
                                            fields: {
                                                id: { editable: false, nullable: true },
                                                price: { type: "number", validation: { required: true, min: 1},editable: false },
                                                useTime: { type: "number" ,validation: { required: true, min: 1},editable: false },
                                                createDateTime: { type: "Date",editable: false },
                                                startDateTime: { type: "Date",editable: false },
                                                endDateTime: { type: "Date",editable: false },
                                                userId: { type: "string" ,editable: false},
                                                status: { type: "number" ,editable: false},
                                                priceName : {type : "string",editable: false},
                                                user :{type:"array",editable: false}
                                            }
                                        }
                                    }
                                });
                                $("#edit-3").kendoGrid({
                                    toolbar:"已绑定价格",
                                    dataSource: dataSource,
                                    pageable: {
                                        // empty:"没有要显示的数据",
                                        // //代表是否支持刷新
                                        // refresh: true,
                                        // //表示每页显示的记录数，默认为5,10,20
                                        pageSizes: true,
                                        // //表示显示的页数，5表示1,2,3,4,5
                                        buttonCount: 5,
                                        totalPages: true,
                                        // input: true,//表示是否可以输入数字
                                        refresh: true,
                                        pageSize: 10,
                                        pageSizes: [5, 10, 15, 20],
                                        // numeric: true,
                                        // input: true,
                                        // messages: {
                                        //     display: "显示 {0}-{1} 条，共 {2} 条",
                                        //     empty: "没有数据",
                                        //     itemsPerPage: "每页显示数量",
                                        //     first: "第一页",
                                        //     last: "最后一页",
                                        //     next: "下一页",
                                        //     previous: "上一页",
                                        //     page: "页",
                                        //     of: "共 {0}页"
                                        // }
                                    },
                                    columnMenu:true,
                                    filterable:true,
                                    resizable: true,
                                    scrollable: true,
                                    sortable:true,
                                    height: 300,
                                    columns: [
                                        { field: "priceName", title: "价格名称",  width: "50px" },
                                        { field: "price", title: "价格(元)", width: "50px" },
                                        { field: "useTime", title:"使用时长",width: "50px" },
                                        { field: "startDateTime", title:"开始时间",width: "50px" ,format: "{0: yyyy-MM-dd}"},
                                        { field: "endDateTime", title:"结束时间",width: "50px",format: "{0: yyyy-MM-dd}" }],
                                    editable: false
                                });
                                $("#edit-4").kendoGrid({
                                    toolbar: [ "未绑定价格"],
                                    dataSource: dataSource1,
                                    sortable:true,
                                    pageable: true,
                                    filterable:true,
                                    resizable: true,
                                    scrollable: true,
                                    height: 300,
                                    columns: [
                                        { field: "priceName", title: "价格",  width: "50px" },
                                        { field: "price", title: "价格", width: "50px" },
                                        { field: "useTime", title:"使用时长",width: "50px" },
                                        { field: "startDateTime", title:"开始时间",width: "50px",format: "{0: yyyy-MM-dd}" },
                                        { field: "endDateTime", title:"结束时间",width: "50px" ,format: "{0: yyyy-MM-dd}"},
                                        // { title: "绑定", width: 80,template: "<button class='row-number'>绑定</button>"},
                                        { command: [{
                                                name :"价格绑定",click:function (e) {
                                                    var tr = $(e.target).closest("tr");
                                                    var data = this.dataItem(tr);
                                                    var priceId = data. id;
                                                    let list1 = {
                                                        price :  priceId,
                                                        deviceId : deviceId
                                                    };
                                                    $.ajax({
                                                        type: "POST",
                                                        url: "./price/deviceSavePrice",
                                                        data: kendo.stringify(list1),
                                                        contentType: "application/json; charset=utf-8",
                                                        dataType: "json",
                                                        success:function (data) {
                                                            alert("保存成功");
                                                        }

                                                    })
                                                }
                                            }], title: "&nbsp;", width: "50px" },],
                                    editable: true
                                });
                            },
                        });
                    }

                    function customBoolEditor(container, options) {
                        var guid = kendo.guid();
                        $('<input class="k-checkbox" id="' + guid + '" type="checkbox" name="Discontinued" data-type="boolean" data-bind="checked:Discontinued">').appendTo(container);
                        $('<label class="k-checkbox-label" for="' + guid + '">&#8203;</label>').appendTo(container);
                    }
                });


            </script>
            <style>
                .k-edit-form-container
                {
                    width: 700px;
                }
                .k-detail-cell .k-tabstrip .k-content {
                    padding: 0.2em;
                }
                .employee-details ul
                {
                    list-style:none;
                    font-style:italic;
                    margin: 15px;
                    padding: 0;
                }
                .employee-details ul li
                {
                    margin: 0;
                    line-height: 1.7em;
                }

                .employee-details label
                {
                    display:inline-block;
                    width:90px;
                    padding-right: 10px;
                    text-align: right;
                    font-style:normal;
                    font-weight:bold;
                }
            </style>
        </div>

        </div>
        </div>

<footer th:replace="fragments/footer::footer"/>
<aside th:replace="fragments/menu"/>

</body>
</html>